Flow org.gluu.agama.totp.otp
     Basepath ""
     Inputs userId
// otp enrollment
Log "@info otp enrollment for user " userId
// Generate secret key 
secretKey = Call org.gluu.agama.totp.TOTPUtil#generateSecretKey "AES"
// secret code uri for QR Code
secretKeyUri | E = Call org.gluu.agama.totp.TOTPUtil#generateTotpSecretKeyUri secretKey "gluu" userId
Log "@info secretKeyUri : " secretKeyUri  E
obj = { secretKeyUri : secretKeyUri }
scanCode = RRF "enroll.ftlh" obj
Log "@info scan code : " scanCode.code
otpCheck | E = Call org.gluu.agama.totp.TOTPUtil#validateTOTP scanCode.code secretKey
Log "@info otp check result " otpCheck
Finish otpCheck